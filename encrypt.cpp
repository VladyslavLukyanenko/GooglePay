#include <iostream>
#include "cipher.h"
#include "base64.h"
#include <sstream>
#include <string.h>

using namespace std;

void to_hex_string( unsigned char x[], int len) {
    unsigned char plain[len+1];
    memcpy(plain, x, len);
    plain[len+1] = '\0';
    for(int i = 0; i < len; i++)
        cout<<plain[i];
}

int main()
{
    string data = "./injector -R v8 -f com.shopify.frenzy.app -s ";

    /*Cipher::encrypt(data);
    string b64encoded = base64_encode(reinterpret_cast<const unsigned char*>(data.c_str()), data.length());
    cout <<b64encoded << endl;
    string b64decoded = base64_decode(b64encoded);
    //cout << "b64 dec: " << b64decoded << endl;
    Cipher::decrypt(b64decoded);
    cout << "Decrypted: " << b64decoded;*/
    //unsigned char plain[] = { 0x37,0x6c,0x48,0x37,0x30,0x6e,0x4b,0x73,0x70,0x71,0x58,0x72,0x73,0x71,0x47,0x54,0x61,0x54,0x59,0x43,0x2b,0x77,0x38,0x39,0x78,0x71,0x4d,0x4c,0x35,0x58,0x45,0x50,0x6b,0x37,0x63,0x56,0x6c,0x41,0x55,0x46,0x42,0x51,0x55,0x3d };
    //cout<<to_hex_string(plain);
    unsigned char plain[] = {0x44, 0x77, 0x74, 0x2f, 0x6b, 0x62, 0x76, 0x4b, 0x79, 0x4e, 0x73, 0x65, 0x35, 0x50, 0x58, 0x55, 0x34, 0x6d, 0x34, 0x34, 0x41, 0x67, 0x3d, 0x3d };

    to_hex_string(plain, strlen((char*)plain));
    return 0;
}
